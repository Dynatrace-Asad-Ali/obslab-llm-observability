{"version":14,"variables":[],"tiles":{"0":{"type":"markdown","title":"","content":"![weaviate logo](https://weaviate.io/assets/images/weaviate-nav-logo-light-532fdca50b4e5f974111eaf70c36080c.svg)\n# Tombstone Analysis"},"1":{"type":"data","title":"Active Tombstones in HNSW index","query":"timeseries vector_index_tombstones=avg(vector_index_tombstones)","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"lineChart","visualizationSettings":{"thresholds":[{"id":"0","title":"","field":"vector_index_tombstones","rules":[{"id":"0","label":"","comparator":"≥","color":"#7dc540"},{"id":"1","label":"","comparator":"≥","color":"#f5d30f"},{"id":"2","label":"","comparator":"≥","color":"#dc172a"}],"isEnabled":true}],"chartSettings":{"seriesOverrides":[],"gapPolicy":"gap","legend":{"hidden":true},"leftYAxisSettings":{"label":""},"categoricalBarChartSettings":{},"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["vector_index_tombstones"],"leftAxisDimensions":[]},"hiddenLegendFields":[]},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"histogram":{"dataMappings":[{"valueAxis":"interval","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"2":{"type":"data","title":"Vectors Inserted","query":"timeseries vector_index_operations=sum(vector_index_operations), filter: { operation==\"create\" }","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"lineChart","visualizationSettings":{"thresholds":[{"id":"0","title":"","field":"vector_index_operations","rules":[{"id":"0","label":"","comparator":"≥","color":"#7dc540"},{"id":"1","label":"","comparator":"≥","color":"#f5d30f"},{"id":"2","label":"","comparator":"≥","color":"#dc172a"}],"isEnabled":true}],"chartSettings":{"seriesOverrides":[],"gapPolicy":"gap","legend":{"hidden":true},"leftYAxisSettings":{"label":""},"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["vector_index_operations"],"leftAxisDimensions":[]},"categoricalBarChartSettings":{},"hiddenLegendFields":[]},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"histogram":{"dataMappings":[{"valueAxis":"interval","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"3":{"type":"markdown","title":"","content":"## Vector Index Statistics"},"4":{"type":"data","title":"Vectors Deleted","query":"timeseries vector_index_operations=sum(vector_index_operations), filter: { operation==\"delete\" }","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"lineChart","visualizationSettings":{"thresholds":[{"id":"0","title":"","field":"vector_index_operations","rules":[{"id":"0","label":"","comparator":"≥","color":"#7dc540"},{"id":"1","label":"","comparator":"≥","color":"#f5d30f"},{"id":"2","label":"","comparator":"≥","color":"#dc172a"}],"isEnabled":true}],"chartSettings":{"seriesOverrides":[],"gapPolicy":"gap","legend":{"hidden":true},"leftYAxisSettings":{"label":""},"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["vector_index_operations"],"leftAxisDimensions":[]},"categoricalBarChartSettings":{},"hiddenLegendFields":[]},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"histogram":{"dataMappings":[{"valueAxis":"interval","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"5":{"type":"markdown","title":"","content":"TODO: Net Vectors\n\nLine 199 of `https://github.com/weaviate/weaviate/blob/main/tools/dev/grafana/dashboards/tombstones.json`\n\n```\nsum(vector_index_operations{operation=\\\"create\\\"}) - ignoring(operation) sum(vector_index_operations{operation=\\\"delete\\\"})\n```"},"6":{"type":"data","title":"Weaviate goroutines","query":"timeseries go_goroutines=avg(go_goroutines), filter: { k8s.deployment.name==\"weaviate-semantic-cache\"}","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"lineChart","visualizationSettings":{"thresholds":[{"id":"0","title":"","field":"go_goroutines","rules":[{"id":"0","label":"","comparator":"≥","color":"#7dc540"},{"id":"1","label":"","comparator":"≥","color":"#f5d30f"},{"id":"2","label":"","comparator":"≥","color":"#dc172a"}],"isEnabled":true}],"chartSettings":{"seriesOverrides":[],"gapPolicy":"gap","legend":{"hidden":true},"leftYAxisSettings":{"label":""},"categoricalBarChartSettings":{},"hiddenLegendFields":[]},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value","recordField":"error"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square","dataMappings":{}}}},"7":{"type":"data","title":"Reassign by Shard Name","query":"timeseries tombstone_reassign_neighbors=sum(tombstone_reassign_neighbors), by: { shard_name }\n| sort arraySum(tombstone_reassign_neighbors) desc\n| limit 20","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"lineChart","visualizationSettings":{"thresholds":[{"id":"0","title":"","field":"tombstone_reassign_neighbors","rules":[{"id":"0","label":"","comparator":"≥","color":"#7dc540"},{"id":"1","label":"","comparator":"≥","color":"#f5d30f"},{"id":"2","label":"","comparator":"≥","color":"#dc172a"}],"isEnabled":true}],"chartSettings":{"seriesOverrides":[],"gapPolicy":"gap","legend":{"hidden":true},"leftYAxisSettings":{"label":""},"categoricalBarChartSettings":{"categoryAxis":"shard_name","categoryAxisLabel":"shard_name","valueAxis":"interval","valueAxisLabel":"interval"},"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["tombstone_reassign_neighbors"],"leftAxisDimensions":["shard_name"]}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","recordField":"shard_name","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square"}}},"8":{"type":"markdown","title":"","content":"## Weaviate goroutines\n"},"9":{"type":"markdown","title":"","content":"## Tombstone Reassign Neighbors"},"10":{"type":"data","title":"Global Entrypoint by Shard Name","query":"timeseries tombstone_find_global_entrypoint=sum(tombstone_find_global_entrypoint), by: { shard_name }\n| sort arraySum(tombstone_find_global_entrypoint) desc\n| limit 20","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"lineChart","visualizationSettings":{"thresholds":[{"id":"0","title":"","field":"tombstone_find_global_entrypoint","rules":[{"id":"0","label":"","comparator":"≥","color":"#7dc540"},{"id":"1","label":"","comparator":"≥","color":"#f5d30f"},{"id":"2","label":"","comparator":"≥","color":"#dc172a"}],"isEnabled":true}],"chartSettings":{"seriesOverrides":[],"gapPolicy":"gap","legend":{"hidden":false},"leftYAxisSettings":{"label":""},"categoricalBarChartSettings":{"categoryAxis":"shard_name","categoryAxisLabel":"shard_name","valueAxis":"interval","valueAxisLabel":"interval"},"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["tombstone_find_global_entrypoint"],"leftAxisDimensions":["shard_name"]},"hiddenLegendFields":["tombstone_find_global_entrypoint"]},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","recordField":"shard_name","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square"}}},"11":{"type":"data","title":"Local Entrypoint by Shard Name","query":"timeseries tombstone_find_local_entrypoint=sum(tombstone_find_local_entrypoint), by: { shard_name }\n| sort arraySum(tombstone_find_local_entrypoint) desc\n| limit 20","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"lineChart","visualizationSettings":{"thresholds":[{"id":"0","title":"","field":"tombstone_find_global_entrypoint","rules":[{"id":"0","label":"","comparator":"≥","color":"#7dc540"},{"id":"1","label":"","comparator":"≥","color":"#f5d30f"},{"id":"2","label":"","comparator":"≥","color":"#dc172a"}],"isEnabled":true}],"chartSettings":{"seriesOverrides":[],"gapPolicy":"gap","legend":{"hidden":false},"leftYAxisSettings":{"label":""},"categoricalBarChartSettings":{"categoryAxis":"shard_name","categoryAxisLabel":"shard_name","valueAxis":"interval","valueAxisLabel":"interval"},"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["tombstone_find_local_entrypoint"],"leftAxisDimensions":["shard_name"]},"hiddenLegendFields":["tombstone_find_local_entrypoint"]},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","recordField":"shard_name","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square"}}},"12":{"type":"markdown","title":"","content":"## Find Local & Global Entrypoints"},"13":{"type":"data","title":"Tombstone Delete List Size by Class & Shard","query":"timeseries tombstone_delete_list_size=avg(tombstone_delete_list_size), by: { shard_name, class_name }\n| sort arrayAvg(tombstone_delete_list_size) desc\n| limit 20","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"lineChart","visualizationSettings":{"thresholds":[{"id":"0","title":"","field":"tombstone_delete_list_size","rules":[{"id":"0","label":"","comparator":"≥","color":"#7dc540"},{"id":"1","label":"","comparator":"≥","color":"#f5d30f"},{"id":"2","label":"","comparator":"≥","color":"#dc172a"}],"isEnabled":true}],"chartSettings":{"seriesOverrides":[],"gapPolicy":"gap","legend":{"hidden":false},"leftYAxisSettings":{"label":""},"categoricalBarChartSettings":{"categoryAxis":"shard_name","categoryAxisLabel":"shard_name","valueAxis":"interval","valueAxisLabel":"interval"},"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["tombstone_delete_list_size"],"leftAxisDimensions":["shard_name","class_name"]},"hiddenLegendFields":[]},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","recordField":"shard_name","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"histogram":{"dataMappings":[{"valueAxis":"interval","rangeAxis":""}]},"honeycomb":{"shape":"square","dataMappings":{"category":"shard_name","value":"class_name"}}}},"14":{"type":"markdown","title":"","content":"## Tombstone Delete List"}},"layouts":{"0":{"x":0,"y":0,"w":10,"h":7},"1":{"x":0,"y":7,"w":8,"h":6},"2":{"x":0,"y":14,"w":8,"h":6},"3":{"x":0,"y":13,"w":24,"h":1},"4":{"x":8,"y":14,"w":8,"h":6},"5":{"x":16,"y":14,"w":8,"h":6},"6":{"x":0,"y":21,"w":8,"h":6},"7":{"x":8,"y":21,"w":9,"h":6},"8":{"x":0,"y":20,"w":8,"h":1},"9":{"x":8,"y":20,"w":10,"h":1},"10":{"x":0,"y":28,"w":8,"h":6},"11":{"x":8,"y":28,"w":8,"h":6},"12":{"x":0,"y":27,"w":24,"h":1},"13":{"x":0,"y":35,"w":8,"h":6},"14":{"x":0,"y":34,"w":24,"h":1}}}